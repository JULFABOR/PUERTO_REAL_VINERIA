{% extends 'base.html' %}
{% block title %}Panel • Puerto Real{% endblock %}
{% block body %}
    {% include 'partials/navbar_privado.html' %}


    <main class="max-w-7xl mx-auto px-4 py-6 space-y-6">
        <!-- Badge Estado Caja -->
        <div>
            {% if estado_caja == 'ABIERTO' %}
                <span class="inline-flex items-center px-2.5 py-1 rounded-full bg-green-100 text-green-800 text-sm">Caja ABIERTO</span>
            {% else %}
                <span class="inline-flex items-center px-2.5 py-1 rounded-full bg-red-100 text-red-800 text-sm">Caja CERRADO</span>
            {% endif %}
            <span class="ml-3 text-sm text-gray-600">Saldo: ${{ saldo_caja|floatformat:2 }}</span>
        </div>


    <!-- Acciones rápidas -->
    <div class="flex flex-wrap gap-3">
        {% for a in acciones %}
            {% if a == 'Abrir Caja' %}
                <a href="{% url 'home:fn_caja' %}" class="px-3 py-2 rounded bg-gray-900 text-white">Abrir Caja</a>
            {% elif a == 'Nueva Venta' %}
                <a href="{% url 'home:fn_ventas' %}" class="px-3 py-2 rounded bg-gray-900 text-white">Nueva Venta</a>
            {% elif a == 'Nueva Compra' %}
                <a href="{% url 'home:fn_compras' %}" class="px-3 py-2 rounded border">Nueva Compra</a>
            {% elif a == 'Control de Stock' %}
                <a href="{% url 'home:fn_stock' %}" class="px-3 py-2 rounded border">Control de Stock</a>
            {% elif a == 'Cargar puntos (QR última venta)' %}
                <a href="{% url 'home:fn_fidelizacion' %}" class="px-3 py-2 rounded border">Cargar puntos (QR)</a>
            {% elif a == 'Fidelización' %}
                <a href="{% url 'home:fn_fidelizacion' %}" class="px-3 py-2 rounded border">Fidelización</a>
            {% endif %}
        {% endfor %}
    </div>


    <!-- Buscador Global -->
    <form method="get" action="#" class="flex gap-2">
        <input name="q" placeholder="Buscar productos, ventas, compras, clientes…" class="flex-1 border rounded px-3 py-2" />
        <button class="px-3 py-2 rounded bg-gray-900 text-white">Buscar</button>
    </form>


    <!-- Cards de módulos -->
    <div class="grid md:grid-cols-3 gap-4">
        {% for c in cards_modulos %}
            <a href="{{ c.href }}" class="block bg-white border rounded-xl p-4 hover:shadow">
                <div class="font-semibold">{{ c.titulo }}</div>
                <div class="text-sm text-gray-600">{{ c.desc }}</div>
            </a>
        {% endfor %}
    </div>


    <!-- Mini KPI del día -->
    <div class="grid md:grid-cols-3 gap-4">
        <div class="bg-white border rounded-xl p-4"><div class="text-sm text-gray-500">Ventas (hoy)</div><div class="text-2xl font-bold">${{ kpi.ventas_dia|floatformat:2 }}</div></div>
        <div class="bg-white border rounded-xl p-4"><div class="text-sm text-gray-500">Tickets</div><div class="text-2xl font-bold">{{ kpi.tickets_dia }}</div></div>
        <div class="bg-white border rounded-xl p-4"><div class="text-sm text-gray-500">Egresos</div><div class="text-2xl font-bold">${{ kpi.egresos_dia|floatformat:2 }}</div></div>
    </div>


    <!-- Alertas -->
    {% if alertas %}
        <div class="space-y-2">
            {% for a in alertas %}
                <div class="p-3 rounded {{ 'bg-yellow-50 border-yellow-200' if a.tipo == 'warn' else 'bg-red-50 border-red-200' }} border">{{ a.msg }}</div>
            {% endfor %}
        </div>
    {% endif %}


    <!-- Ir al HOME completo -->
        <div>
            <a href="{% url 'home:home_inicio' %}" class="px-4 py-2 rounded bg-gray-900 text-white">Ir al HOME (Dashboard)</a>
        </div>
    </main>
{% endblock %}